<!-- 
    MODERN ROSTER SCROLL EFFECT - VERSIÓN PARA ELEMENTOR
    Copia todo este código en un bloque HTML de Elementor
-->

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
    href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:wght@400;500;600;700;800;900&family=Inter:wght@400;500;700;900&display=swap"
    rel="stylesheet">

<style>
    .roster-scroll-effect * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .roster-scroll-effect {
        font-family: 'Inter', sans-serif;
        background: transparent;
        color: #000;
    }

    .bodoni-moda {
        font-family: 'Bodoni Moda', serif;
    }

    /* Roster Section - ALTURA AJUSTABLE */
    .roster-section {
        height: 500vh;
        position: relative;
        background: transparent;
    }

    /* Ajustar altura en tablet y móvil */
    @media (max-width: 1024px) {
        .roster-section {
            height: 350vh;
        }
    }

    @media (max-width: 768px) {
        .roster-section {
            height: 300vh;
        }
    }

    @media (max-width: 480px) {
        .roster-section {
            height: 260vh;
        }
    }

    /* iOS Safari: position:sticky necesita -webkit-sticky */
    .roster-sticky {
        position: -webkit-sticky;
        position: sticky;
        top: 0;
        height: 100vh;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        /* Forzar GPU layer propio para evitar repaints */
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
    }

    /* Texto Marquesina */
    .marquee-text {
        position: absolute;
        white-space: nowrap;
        pointer-events: none;
        user-select: none;
        z-index: 10;
        /* will-change solo en desktop (ver media query) */
    }

    .marquee-text h2 {
        font-size: 42vw;
        line-height: 0.8;
        letter-spacing: -0.05em;
        text-transform: uppercase;
        color: #000;
        opacity: 0.3;
    }

    /* will-change solo cuando hay mouse (desktop) */
    @media (min-width: 769px) and (hover: hover) {

        .marquee-text,
        .person-card {
            will-change: transform;
        }
    }

    /* Contenedor de Tarjetas */
    .cards-container {
        position: relative;
        width: 100%;
        height: 100%;
        max-width: 1920px;
        margin: 0 auto;
        pointer-events: none;
    }

    /* Tarjeta de Persona */
    .person-card {
        position: absolute;
        pointer-events: auto;
        width: 18vw;
        min-width: 200px;
        -webkit-transform: translateY(0);
        transform: translateY(0);
    }

    .card-inner {
        position: relative;
    }

    .card-image-wrapper {
        overflow: hidden;
        border-radius: 2px;
        background: #18181b;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        /* Capa GPU propia para cada imagen */
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
    }

    /* Hover/zoom solo en dispositivos con mouse real */
    @media (hover: hover) and (pointer: fine) {
        .card-image-wrapper {
            transition: transform 0.7s ease-out;
        }

        .person-card:hover .card-image-wrapper {
            transform: scale(1.05);
        }
    }

    .card-image {
        width: 100%;
        height: auto;
        aspect-ratio: 3/4;
        object-fit: cover;
        display: block;
        filter: grayscale(100%);
        /* Sin transitions en touch (rendimiento) */
    }

    /* Color al hover solo con mouse */
    @media (hover: hover) and (pointer: fine) {
        .card-image {
            transition: filter 1s ease;
        }

        .person-card:hover .card-image {
            filter: grayscale(0%);
        }
    }

    .card-label {
        position: absolute;
        bottom: -1rem;
        left: -1rem;
        padding: 0.5rem 1.5rem;
        font-size: 10px;
        font-weight: 900;
        letter-spacing: 0.2em;
        text-transform: uppercase;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    }

    @media (hover: hover) and (pointer: fine) {
        .card-label {
            transition: transform 0.3s ease;
        }

        .person-card:hover .card-label {
            transform: translateY(-0.5rem);
        }
    }

    .card-label-front {
        background: white;
        color: black;
    }

    .card-label-back {
        background: #27272a;
        color: white;
    }

    /* Responsive - Tablet */
    @media (max-width: 1024px) {
        .person-card {
            width: 25vw;
            min-width: 180px;
        }

        .marquee-text h2 {
            font-size: 50vw;
        }

        .card-label {
            font-size: 8px;
            padding: 0.4rem 1rem;
        }
    }

    /* Responsive - Móvil: 2 columnas, 42vw cada tarjeta */
    @media (max-width: 768px) {
        .person-card {
            width: 42vw !important;
            min-width: 0;
        }

        .marquee-text h2 {
            font-size: 65vw;
        }

        .card-label {
            font-size: 7px;
            padding: 0.3rem 0.8rem;
            letter-spacing: 0.15em;
        }

        .card-image-wrapper {
            box-shadow: 0 15px 30px -10px rgba(0, 0, 0, 0.3);
        }
    }

    @media (max-width: 480px) {
        .marquee-text h2 {
            font-size: 80vw;
            letter-spacing: -0.08em;
        }

        .card-label {
            font-size: 6px;
            padding: 0.25rem 0.6rem;
            letter-spacing: 0.1em;
            bottom: -0.75rem;
            left: -0.75rem;
        }
    }
</style>

<!-- HTML del efecto -->
<div class="roster-scroll-effect">
    <section class="roster-section" id="roster-section-elementor">
        <div class="roster-sticky">
            <!-- Texto Marquesina -->
            <div class="marquee-text" id="marquee-elementor">
                <h2 class="bodoni-moda">ROSTER</h2>
            </div>

            <!-- Contenedor de Tarjetas -->
            <div class="cards-container" id="cards-container-elementor">
                <!-- Las tarjetas se generan con JavaScript -->
            </div>
        </div>
    </section>
</div>

<!-- JavaScript (NECESARIO) -->
<script>
    (function () {
        'use strict';

        // ─── Detección de iOS Safari ────────────────────────────────────────
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
        const isIOSSafari = isIOS || (isSafari && 'ontouchstart' in window);

        // En iOS: intensidad reducida para evitar jank
        const PARALLAX_INTENSITY = isIOSSafari ? 0.5 : 1.0;

        // Factor lerp: más suave en iOS, más reactivo en desktop
        const LERP_FACTOR = isIOSSafari ? 0.07 : 0.12;

        // ─── Datos del Roster ────────────────────────────────────────────────
        // x / y = posición en DESKTOP
        // xMobile = posición en MÓVIL (2 columnas: ~5% izq / ~55% der)
        // Posiciones desktop: cuadrícula escalonada en 3 zonas horizontales (izq/centro/der)
        // Posiciones mobile: 2 columnas alternadas (5% izq | 55% der)
        // speed: todos normalizados entre 0.6 y 1.2 para scroll parejo y elegante
        const ROSTER = [
            {
                id: 1,
                name: "JUVE 3D",
                img: "https://fernader.baltazarg.xyz/wp-content/uploads/2026/02/10-Juve-3D-Studio.jpg",
                x: "5%", xMobile: "5%",
                y: "10%",
                speed: 0.8,
                z: 20
            },
            {
                id: 2,
                name: "ADELA MICHA",
                img: "https://fernader.baltazarg.xyz/wp-content/uploads/2026/02/4-Adela-Micha.jpg",
                x: "75%", xMobile: "55%",
                y: "5%",
                speed: 1.0,
                z: 10
            },
            {
                id: 3,
                name: "RAFA JAIME",
                img: "https://fernader.baltazarg.xyz/wp-content/uploads/2026/02/15.1-Rafa-Jaime.jpg",
                x: "38%", xMobile: "5%",
                y: "50%",
                speed: 0.6,
                z: 5
            },
            {
                id: 4,
                name: "PATRICIA GUERRA",
                img: "https://fernader.baltazarg.xyz/wp-content/uploads/2026/02/14-Patricia-Guerra.jpg",
                x: "8%", xMobile: "55%",
                y: "65%",
                speed: 1.1,
                z: 15
            },
            {
                id: 5,
                name: "DR. NIRDOSH KOHRA",
                img: "https://fernader.baltazarg.xyz/wp-content/uploads/2026/02/18-Dr-Nirdosh-Kohra.jpg",
                x: "68%", xMobile: "5%",
                y: "55%",
                speed: 1.2,
                z: 20
            },
            {
                id: 6,
                name: "FERNANDA ALVAREZ",
                img: "https://fernader.baltazarg.xyz/wp-content/uploads/2026/02/20-Fernanda-Alvarez.jpg",
                x: "42%", xMobile: "55%",
                y: "15%",
                speed: 0.7,
                z: 8
            },
            {
                id: 7,
                name: "OTRO",
                img: "https://fernader.baltazarg.xyz/wp-content/uploads/2026/02/3-Silvia-Navarro.jpg",
                x: "82%", xMobile: "5%",
                y: "70%",
                speed: 0.9,
                z: 12
            }
        ];

        // ─── Crear tarjetas ─────────────────────────────────────────────────
        const cardsContainer = document.getElementById('cards-container-elementor');
        if (!cardsContainer) {
            console.error('Cards container not found');
            return;
        }

        ROSTER.forEach(function (person) {
            const card = document.createElement('div');
            card.className = 'person-card';
            card.dataset.xDesktop = person.x;
            card.dataset.xMobile = person.xMobile;
            card.dataset.speed = person.speed;
            card.style.top = person.y;
            card.style.zIndex = person.z;

            const labelClass = person.z > 10 ? 'card-label-front' : 'card-label-back';

            card.innerHTML =
                '<div class="card-inner">' +
                '<div class="card-image-wrapper">' +
                '<img src="' + person.img + '" alt="' + person.name + '" class="card-image" loading="lazy">' +
                '</div>' +
                '<div class="card-label ' + labelClass + '">' +
                person.name +
                '</div>' +
                '</div>';

            cardsContainer.appendChild(card);
        });

        // ─── Referencias DOM ────────────────────────────────────────────────
        const rosterSection = document.getElementById('roster-section-elementor');
        const marquee = document.getElementById('marquee-elementor');
        const personCards = document.querySelectorAll('.person-card');

        // ─── Distribución por breakpoint ────────────────────────────────────
        function applyResponsivePositions() {
            const isMobile = window.innerWidth <= 768;
            personCards.forEach(function (card) {
                card.style.left = isMobile
                    ? card.dataset.xMobile
                    : card.dataset.xDesktop;
            });
        }

        applyResponsivePositions();

        // ─── Estado del parallax ─────────────────────────────────────────────
        let currentProgress = 0;
        let targetProgress = 0;
        let rafId = null;
        let lastProgress = -1;

        function lerp(a, b, t) {
            return a + (b - a) * t;
        }

        function getScrollProgress() {
            const rect = rosterSection.getBoundingClientRect();
            const sectionH = rosterSection.offsetHeight;
            const viewportH = window.innerHeight;
            const scrollEnd = sectionH - viewportH;
            if (scrollEnd <= 0) return 0;
            const scrollStart = -rect.top;
            return Math.max(0, Math.min(1, scrollStart / scrollEnd));
        }

        function applyParallax(progress) {
            const isMobile = window.innerWidth <= 768;
            const sectionTop = rosterSection.getBoundingClientRect().top;
            const sectionBottom = rosterSection.getBoundingClientRect().bottom;

            // Solo animar cuando la sección está visible
            if (sectionBottom <= 0 || sectionTop >= window.innerHeight) return;

            // Marquesina: de derecha a izquierda — rango reducido para movimiento más lento
            const xMarquee = 40 + (progress * -160);
            marquee.style.transform = 'translateX(' + xMarquee + '%)';
            marquee.style.webkitTransform = 'translateX(' + xMarquee + '%)';

            // Imágenes: parallax vertical — multiplicadores más bajos para scroll más elegante
            personCards.forEach(function (card) {
                const speed = parseFloat(card.dataset.speed) || 1;

                // En móvil: rango reducido para que las tarjetas no se salgan
                const rangeFactor = isMobile ? 0.5 : 1.0;

                const yStart = 220 * speed * rangeFactor * PARALLAX_INTENSITY;
                const yEnd = -280 * speed * rangeFactor * PARALLAX_INTENSITY;
                const yPos = yStart + (progress * (yEnd - yStart));

                card.style.transform = 'translateY(' + yPos + 'px)';
                card.style.webkitTransform = 'translateY(' + yPos + 'px)';
            });
        }

        // ─── Loop rAF con lerp ───────────────────────────────────────────────
        function animationLoop() {
            currentProgress = lerp(currentProgress, targetProgress, LERP_FACTOR);

            const delta = Math.abs(currentProgress - lastProgress);
            if (delta > 0.0001) {
                applyParallax(currentProgress);
                lastProgress = currentProgress;
            }

            // Detener el loop cuando ya convergió
            if (delta < 0.00005) {
                rafId = null;
                return;
            }

            rafId = requestAnimationFrame(animationLoop);
        }

        function onScroll() {
            targetProgress = getScrollProgress();
            if (!rafId) {
                rafId = requestAnimationFrame(animationLoop);
            }
        }

        function onResize() {
            applyResponsivePositions();
            targetProgress = getScrollProgress();
            currentProgress = targetProgress; // sin lerp en resize
            applyParallax(currentProgress);
        }

        // ─── Listeners ──────────────────────────────────────────────────────
        window.addEventListener('scroll', onScroll, { passive: true });
        window.addEventListener('resize', onResize, { passive: true });

        // Estado inicial (sin lerp)
        currentProgress = getScrollProgress();
        targetProgress = currentProgress;
        applyParallax(currentProgress);

    })();
</script>